<%- include('../admin/layouts/admin-header.ejs') %>























    <main class="h-full pb-16 overflow-y-auto">
        <div class="container px-6 mx-auto grid">
            <h2 class="my-6 text-2xl font-semibold text-gray-700 dark:text-gray-200">
                Edit Product
            </h2>

            <!-- General elements -->
            <form class="row" action="/admin/products/edit-product/<%= Product._id %>" method="POST">
                <h4 class="mb-4 text-lg font-semibold text-gray-600 dark:text-gray-300">

                </h4>
                <div class="px-4 py-3 mb-8 bg-white rounded-lg shadow-md dark:bg-gray-800">
                    <div class="mb-4">
                        <label for="product_name" class="block text-sm form-label">
                            <span class="text-gray-700 dark:text-gray-400">Product title</span>
                        </label>
                        <input type="text" name="productName" id=""
                            class="form-control block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                            value="<%= Product.productName %>" required  />
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm form-label">
                            <span class="text-gray-700 dark:text-gray-400">Full description</span>
                        </label>

                        <textarea placeholder="Type here" name="description"
                            class="form-control block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                            required ><%= Product.description %></textarea>
                    </div>

                    <div class="row">
                        <div class="col-lg-4">
                            <div class="mb-4">
                                <label class="form-label block mt-4 text-sm">
                                    <span class="text-gray-700 dark:text-gray-400">
                                        Regular price
                                    </span>
                                </label>
                                <div class="row gx-2">
                                    <input placeholder="$" type="number"
                                        class="form-control block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                                        name="Price" value="<%= Product.Price %>" required />
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-4">
                            <div class="mb-4">
                                <label class="form-label block mt-4 text-sm">
                                    <span class="text-gray-700 dark:text-gray-400">
                                        stock
                                    </span>
                                </label>
                                <div class="row gx-2">
                                    <input placeholder="$" type="number"
                                        class="form-control block w-full mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:text-gray-300 dark:focus:shadow-outline-gray form-input"
                                        name="Stock" value="<%= Product. Stock %>" required />
                                </div>
                            </div>
                        </div>
                    </div>
                    
    
                    <div class="px-6 my-6">
                        <button style="margin-bottom: 2%;" type="submit"
                        class="btn btn-primary">
                            Edit Product
                            <span class="ml-2" aria-hidden="true"></span>
                        </button>
                    </div>
               
            
            
                <div class="px-6 my-6">
                 <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModl">
                  Edit Images</button>
                </div>
              </div>
              </form>
                <div class="modal fade " id="exampleModl" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h1 class="modal-title fs-5" id="exampleModalLabel"> Product Image</h1>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          <div class="mb-3">
                            <label for="recipient-name" name="orderStatus" class="col-form-label"
                              style="font-size: 18px; font-weight: bold; text-decoration: underline;">Image Edits</label>
                          </div>
                  
                          <div class="row">
                            <% for(var i=0;i<Product.image_url.length;i+=2) { %>
                            <div class="col-md-6">
                              <form action="/admin/image-edit/<%= Product.image_url[i].public_id %>/<%= Product._id %>" method="POST" enctype="multipart/form-data" class="text-center">
                                <div class="image-container border p-2" style="border-width: 4px;">
                                  <img src="<%= Product.image_url[i].url %>" style="width:50%; height:30%; object-fit:contain; display:block; margin:auto;">
                                  <input style="width: 50%;
                                  margin: auto;" type="file" id="file" name="images" onchange="return fileValidation()" multiple>                    <button class="update-image-btn btn btn-sm btn-success mt-2 mx-auto d-block">Update Image</button>
                                </div>
                              </form>
                            </div>
                            <% if (i+1 < Product.image_url.length) { %>
                            <div class="col-md-6">
                              <form action="/admin/image-edit/<%= Product.image_url[i+1].public_id %>/<%=Product._id %>" method="POST" enctype="multipart/form-data" class="text-center">
                                <div class="image-container border p-2" style="border-width: 4px;">
                                  <img src="<%= Product.image_url[i+1].url %>" style="width:50%; height:30%; object-fit:contain; display:block; margin:auto;">
                                 <input style="width: 50%;
                                 margin: auto;" type="file" id="file" name="images" onchange="return fileValidation()" multiple>
                                  <button class="update-image-btn btn btn-sm btn-success mt-2 mx-auto d-block">Update Image</button>
                                </div>
                              </form>
                            </div>
                            <% } %>
                            <% } %>
                          </div>
                          
                  
                          <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

        </div>
    </main>
 <!-- Bootstrap core JavaScript-->
     <script src="/public/startbootstrap-sb-admin-2-gh-pages/vendor/jquery/jquery.min.js"></script>
     <script src="/public/startbootstrap-sb-admin-2-gh-pages/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
 
     <!-- Core plugin JavaScript-->
     <script src="/public/startbootstrap-sb-admin-2-gh-pages/vendor/jquery-easing/jquery.easing.min.js"></script>
 
     <!-- Custom scripts for all pages-->
     <script src="/public/startbootstrap-sb-admin-2-gh-pages/js/sb-admin-2.min.js"></script>
 
     <!-- Page level plugins -->
     <script src="/public/startbootstrap-sb-admin-2-gh-pages/vendor/datatables/jquery.dataTables.min.js"></script>
     <script src="/public/startbootstrap-sb-admin-2-gh-pages/vendor/datatables/dataTables.bootstrap4.min.js"></script>
 
     <!-- Page level custom scripts -->
     <script src="/public/startbootstrap-sb-admin-2-gh-pages/js/demo/datatables-demo.js"></script>

     
 
 
 
    <!-- CSS only -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css">

<!-- JavaScript Bundle with Popper -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>

<!-- jQuery library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>





<script>
    function fileValidations() {
      var fileInput =
        document.getElementById('image');

      var filePath = fileInput.value;

      // Allowing file type
      var allowedExtensions =
        /(\.jpg|\.jpeg|\.png)$/i;

      if (!allowedExtensions.exec(filePath)) {
        alert('Invalid file type');
        fileInput.value = '';
        return false;
      }
    }
  </script>