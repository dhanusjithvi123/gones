
<!DOCTYPE html>
<html lang="en">

<head>
	
    <meta charset="UTF-8">
	<title>G ONE</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--===============================================================================================-->
    <link rel="icon" type="image/png" href="/public/images/icons/favicon.png" />
    <!--===============================================================================================-->
     <link rel="stylesheet" type="text/css" href="/public/vendor/bootstrap/css/bootstrap.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/fonts/iconic/css/material-design-iconic-font.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/fonts/linearicons-v1.0.0/icon-font.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/vendor/animate/animate.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/vendor/css-hamburgers/hamburgers.min.css">
    <!--===============================================================================================-->
    <!--===============================================================================================-->
    <!-- <link rel="stylesheet" type="text/css" href="/public/vendor/select2/select2.min.css"> -->
    <!--===============================================================================================-->
    <!-- <link rel="stylesheet" type="text/css" href="/public/vendor/daterangepicker/daterangepicker.css"> -->
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/vendor/slick/slick.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/vendor/MagnificPopup/magnific-popup.css"> 
    <!--===============================================================================================-->
    <!-- <link rel="stylesheet" type="text/css" href="/public/vendor/perfect-scrollbar/perfect-scrollbar.css"> -->
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="/public/css/util.css">
    <link rel="stylesheet" type="text/css" href="/public/css/main.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.4/dist/sweetalert2.min.css">

    <!--===============================================================================================-->
	<!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
   
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
      rel="stylesheet"
    />
    <!-- MDB -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.0.1/mdb.min.css"
      rel="stylesheet"
    />
</head>

<body class="animsition">

    <!-- Header -->
    <header class="header-v2">
        <!-- Header desktop -->
        <div class="container-menu-desktop trans-03">
            <div class="wrap-menu-desktop">
                <nav class="limiter-menu-desktop p-l-45">

                    <!-- Logo desktop -->
                    <a href="/" class="logo">
                        <img src="/public/images/icons/logo-01.png" alt="IMG-LOGO">
                    </a>

                    <!-- Menu desktop -->
                    <div class="menu-desktop">
                        <ul class="main-menu">
                            <li class="active-menu">
                                <a href="/">Home</a>
                            </li>

                            <li>
                                <a href="/shop">Shop</a>
                            </li>

                            <!-- <li class="label1" data-label1="hot">
                                <a href="shoping-cart.html"></a>
                            </li> -->

                            <li>
                                <a href="/cart">Cart</a>
                            </li>

                            <li>
                                <a href="about.html">About</a>
                            </li>

                            <li>
                                <a href=""></a>
                            </li>

							<li>
                                <a href="contact.html">Contact</a>
                            </li>
                        </ul>
                    </div>

                    <!-- Icon header -->
					<li class="p-b-13">
						
					</li>
                    <div class="wrap-icon-header flex-w flex-r-m h-full">
                        

                        <div class="flex-c-m h-full p-l-18 p-r-25 bor5">
                            <div class="icon-header-item cl2 hov-cl1 trans-04 p-lr-11 icon-header-noti js-show-cart"
                                data-notify="<%= count.cart %>">
                                <i class="zmdi zmdi-shopping-cart"></i>
                            </div>
                        </div>

                        <div class="flex-c-m h-full p-lr-19">
                            <div class="icon-header-item cl2 hov-cl1 trans-04 p-lr-11 js-show-sidebar">
                                <i class="zmdi zmdi-menu"></i>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
        </div>

        <!-- Header Mobile -->
        <div class="wrap-header-mobile">
            <!-- Logo moblie -->
            <div class="logo-mobile">
                <a href="index.html"><img src="/public/images/icons/logo-01.png" alt="IMG-LOGO"></a>
            </div>

            <!-- Icon header -->
            <div class="wrap-icon-header flex-w flex-r-m h-full m-r-15">
                <div class="flex-c-m h-full p-r-10">
                    <div class="icon-header-item cl2 hov-cl1 trans-04 p-lr-11 js-show-modal-search">
                        <i class="zmdi zmdi-search"></i>
                    </div>
                </div>
                 
				
                <div class="flex-c-m h-full p-lr-10 bor5">
                    <div class="icon-header-item cl2 hov-cl1 trans-04 p-lr-11 icon-header-noti js-show-cart"
                        data-notify="<%= count.cart %>">
                        <i class="zmdi zmdi-shopping-cart"></i>
                    </div>
                </div>
            </div>

            <!-- Button show menu -->
            <div class="btn-show-menu-mobile hamburger hamburger--squeeze">
                <span class="hamburger-box">
                    <span class="hamburger-inner"></span>
                </span>
            </div>
        </div>


        <!-- Menu Mobile -->
        <div class="menu-mobile">
            <ul class="main-menu-m">
                <li>
                    <a href="index.html">Home</a>
                </li>

                <li>
                    <a href="/shop">Shop</a>
                </li>

                <li>
                    <a href="shoping-cart.html" class="label1 rs1" data-label1="hot">Features</a>
                </li>

                <li>
                    <a href="blog.html"></a>
                </li>

                <li>
                    <a href="about.html">About</a>
                </li>
				
                <li>
                    <a href="contact.html">Logout</a>
                </li>
			

				<li>
                    <a href="signup">Sigin</a>
                </li>

				<li>
                    <a href="/login">Login</a>
                </li>
				
            </ul>
        </div>

        <!-- Modal Search -->
        <div class="modal-search-header flex-c-m trans-04 js-hide-modal-search">
            <div class="container-search-header">
                <button class="flex-c-m btn-hide-modal-search trans-04 js-hide-modal-search">
                    <img src="/public/images/icons/icon-close2.png" alt="CLOSE">
                </button>

                <form class="wrap-search-header flex-w p-l-15">
                    <button class="flex-c-m trans-04">
                        <i class="zmdi zmdi-search"></i>
                    </button>
                    <input class="plh3" type="text" name="search" placeholder="Search...">
                </form>
            </div>
        </div>
    </header>
    <!-- Sidebar -->
	<aside class="wrap-sidebar js-sidebar">
		<div class="s-full js-hide-sidebar"></div>

		<div class="sidebar flex-col-l p-t-22 p-b-25">
			<div class="flex-r w-full p-b-30 p-r-27">
				<div class="fs-35 lh-10 cl2 p-lr-5 pointer hov-cl1 trans-04 js-hide-sidebar">
					<i class="zmdi zmdi-close"></i>
				</div>
			</div>

			<div class="sidebar-content flex-w w-full p-lr-65 js-pscroll">
				<ul class="sidebar-link w-full">
					
					<li class="p-b-13">
						<a href="/" class="stext-102 cl2 hov-cl1 trans-04">
							Home
						</a>
					</li>

					<li class="p-b-13">
						<a href="#" class="stext-102 cl2 hov-cl1 trans-04">
							My Wishlist
						</a>
					</li>

					<li class="p-b-13">
						<a href="/viewProfile" class="stext-102 cl2 hov-cl1 trans-04">
							My Account
						</a>
					</li>

					<li class="p-b-13">
						<a href="#" class="stext-102 cl2 hov-cl1 trans-04">
							Track Oder
						</a>
					</li>

					<li class="p-b-13">
						<a href="/logout" class="stext-102 cl2 hov-cl1 trans-04">
							Logout
						</a>
					</li>
					

					<li class="p-b-13">
						<a href="/signup" class="stext-102 cl2 hov-cl1 trans-04">
							Sigin
						</a>
					</li>

					<li class="p-b-13">
						<a href="/login" class="stext-102 cl2 hov-cl1 trans-04">
							Login
						</a>
					</li>
				
					
					
				</ul>
               
				<div class="sidebar-gallery w-full p-tb-30">
					<span class="mtext-101 cl5">
						@ CozaStore
					</span>

					<div class="flex-w flex-sb p-t-36 gallery-lb">
						<!-- item gallery sidebar -->
						<div class="wrap-item-gallery m-b-10">
							<a class="item-gallery bg-img1" href="/public/images/gallery-01.jpg" data-lightbox="gallery" 
							style="background-image: url('/public/images/gallery-01.jpg');"></a>
						</div>

						<!-- item gallery sidebar -->
						<div class="wrap-item-gallery m-b-10">
							<a class="item-gallery bg-img1" href="/public/images/gallery-02.jpg" data-lightbox="gallery" 
							style="background-image: url('/public/images/gallery-02.jpg');"></a>
						</div>

						<!-- item gallery sidebar -->
						<div class="wrap-item-gallery m-b-10">
							<a class="item-gallery bg-img1" href="/public/images/gallery-03.jpg" data-lightbox="gallery" 
							style="background-image: url('/public/images/gallery-03.jpg');"></a>
						</div>

						<!-- item gallery sidebar -->
						<div class="wrap-item-gallery m-b-10">
							<a class="item-gallery bg-img1" href="/public/images/gallery-04.jpg" data-lightbox="gallery" 
							style="background-image: url('/public/images/gallery-04.jpg');"></a>
						</div>

						<!-- item gallery sidebar -->
						<div class="wrap-item-gallery m-b-10">
							<a class="item-gallery bg-img1" href="/public/images/gallery-05.jpg" data-lightbox="gallery" 
							style="background-image: url('/public/images/gallery-05.jpg');"></a>
						</div>

						<!-- item gallery sidebar -->
						<div class="wrap-item-gallery m-b-10">
							<a class="item-gallery bg-img1" href="/public/images/gallery-06.jpg" data-lightbox="gallery" 
							style="background-image: url('/public/images/gallery-06.jpg');"></a>
						</div>

						<!-- item gallery sidebar -->
						<div class="wrap-item-gallery m-b-10">
							<a class="item-gallery bg-img1" href="/public/images/gallery-07.jpg" data-lightbox="gallery" 
							style="background-image: url('/public/images/gallery-07.jpg');"></a>
						</div>

						<!-- item gallery sidebar -->
						<div class="wrap-item-gallery m-b-10">
							<a class="item-gallery bg-img1" href="/public/images/gallery-08.jpg" data-lightbox="gallery" 
							style="background-image: url('/public/images/gallery-08.jpg');"></a>
						</div>

						<!-- item gallery sidebar -->
						<div class="wrap-item-gallery m-b-10">
							<a class="item-gallery bg-img1" href="/public/images/gallery-09.jpg" data-lightbox="gallery" 
							style="background-image: url('/public/images/gallery-09.jpg');"></a>
						</div>
					</div>
				</div>

				<div class="sidebar-gallery w-full">
					<span class="mtext-101 cl5">
						About Us
					</span>

					<p class="stext-108 cl6 p-t-27">
						Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur maximus vulputate hendrerit. Praesent faucibus erat vitae rutrum gravida. Vestibulum tempus mi enim, in molestie sem fermentum quis. 
					</p>
				</div>
			</div>
		</div>
	</aside>


	<!-- Cart -->
	<div class="wrap-header-cart js-panel-cart">
		<div class="s-full js-hide-cart"></div>

		<div class="header-cart flex-col-l p-l-65 p-r-25">
			<div class="header-cart-title flex-w flex-sb-m p-b-8">
				<span class="mtext-103 cl2">
					Your Cart
				</span>

				<div class="fs-35 lh-10 cl2 p-lr-5 pointer hov-cl1 trans-04 js-hide-cart">
					<i class="zmdi zmdi-close"></i>
				</div>
			</div>
			
			<div class="header-cart-content flex-w js-pscroll">
				<ul class="header-cart-wrapitem w-full">
					<li class="header-cart-item flex-w flex-t m-b-12">
						<div class="header-cart-item-img">
							<img src="/public/images/item-cart-01.jpg" alt="IMG">
						</div>

						<div class="header-cart-item-txt p-t-8">
							<a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04">
								White Shirt Pleat
							</a>

							<span class="header-cart-item-info">
								1 x $19.00
							</span>
						</div>
					</li>

					<li class="header-cart-item flex-w flex-t m-b-12">
						<div class="header-cart-item-img">
							<img src="/public/images/item-cart-02.jpg" alt="IMG">
						</div>

						<div class="header-cart-item-txt p-t-8">
							<a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04">
								Converse All Star
							</a>

							<span class="header-cart-item-info">
								1 x $39.00
							</span>
						</div>
					</li>

					<li class="header-cart-item flex-w flex-t m-b-12">
						<div class="header-cart-item-img">
							<img src="/public/images/item-cart-03.jpg" alt="IMG">
						</div>

						<div class="header-cart-item-txt p-t-8">
							<a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04">
								Nixon Porter Leather
							</a>

							<span class="header-cart-item-info">
								1 x $17.00
							</span>
						</div>
					</li>
				</ul>
				
				<div class="w-full">
					<div class="header-cart-total w-full p-tb-40">
						Total: $75.00
					</div>

					<div class="header-cart-buttons flex-w w-full">
						<a href="/viewCart" class="flex-c-m stext-101 cl0 size-107 bg3 bor2 hov-btn3 p-lr-15 trans-04 m-r-8 m-b-10">
							View Cart
						</a>

						<a href="/chackout " class="flex-c-m stext-101 cl0 size-107 bg3 bor2 hov-btn3 p-lr-15 trans-04 m-b-10">
							Check Out
						</a>

						

					</div>
				</div>
			</div>
		</div>
	</div>


<!-- ----------------------------------------  -->

















 

<!-- ------------------------------------------------------  -->





    <div class="container">




        


       

        
        <div class="row">
            <div class="col-md-4 order-md-2 mb-4">
                <h4 class="d-flex justify-content-between align-items-center mb-3">
                    <span class="text-muted">Your cart</span>
                    <span class="badge badge-secondary badge-pill"><%=cartList.length%></span>
                </h4>
                <% var totalAmount=0 %>
                <% cartList.forEach((item)=>{%>
                <ul class="list-group mb-3 sticky-top">
                    <li class="list-group-item d-flex justify-content-between lh-condensed">
                        <div>
                            <h6 class="my-0">Product name</h6>
                            <small class="text-muted"><%=item.product.productName %> × <%= item.cartItems.qty %></small>
                            <% var itemTotal=item.cartItems.qty * item.product.Price %>
                            <% totalAmount +=itemTotal %>
                        </div>
                        <span class="text-muted">$ <span  ><%= itemTotal%> </span>    </span>
                    </li>
                  
                    
                    <li class="list-group-item d-flex justify-content-between bg-light">
                        <div class="text-success">
                            <h6 class="my-0">Promo code</h6>
                            <small>EXAMPLECODE</small>
                        </div>
                        <span class="text-success">-$5</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between">
                        <span>Total (USD)</span>
                        <strong>$<%= itemTotal%></strong>
                    </li>
                </ul>
                <%})%>

                <li class="list-group-item d-flex justify-content-between">
                    <span>Total (USD)</span>
                    <strong>$<%=totalAmount%></strong>
                </li>

                <li class="list-group-item d-flex justify-content-between">
                    <span > Oder Total </span>
                    <strong id="totalAmount"><%=totalAmount-discountAmount%></strong>
                <input type="hidden" id="couponCode" readonly name="couponCode" value="<%=couponCode%>">

                </li>
   

                <form class="card p-2">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Promo code">
                        <div class="input-group-append">
                            <button type="submit" class="btn btn-secondary">Redeem</button>
                        </div>
                    </div>
                </form>
            </div>
            <div class="col-md-8 order-md-1">
                <h4 class="mb-3">Billing address</h4>
                <div class="col-12" >

                    <div class="select_form_select default-form-box">
                        <label for="countru_name">Your Address </label>
                        <select class="niceselect_option wide" name="cuntry" id="countru_name"
                            onchange="updateAddressDetails(this.value)">
                            <option value="2">Select Your Address</option>
                            <% if (userData.addressDetails && userData.addressDetails.length> 0) { %>
                                <% for (let i=0; i < userData.addressDetails.length; i++) { %>

                                    <option value="<%= userData.addressDetails[i]._id %>">
                                        <%= userData.addressDetails[i].Fullname %>
                                            <%= userData.addressDetails[i].houseaddress %>
                                    </option>

                                    <% } %>
                                        <% } else { %>
                                            <p>No address selected</p>
                                            <% } %>
                        </select>
                    </div>
                </div>
                <form class="needs-validation" novalidate="">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="firstName">Name</label>
                            <input type="text" class="form-control" id="name" name="name" placeholder="" value="" required>
                            <div class="invalid-feedback"> Valid first name is required. </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="lastName">State</label>
                            <input type="text" class="form-control" id="state" name="state" placeholder="" value="" required="">
                            <div class="invalid-feedback"> </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="username">Town / City </label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">*</span>
                            </div>
                            <input type="text" class="form-control"  id="city" name="city"  placeholder="city" required="">
                            <div class="invalid-feedback" style="width: 100%;">  </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="email">Email <span class="text-muted">(Optional)</span></label>
                        <input type="email" class="form-control" name="email" id="email" placeholder="you@example.com">
                        <div class="invalid-feedback"> Please enter a valid email address for shipping updates. </div>
                    </div>

                    <div class="mb-3">
                        <label for="address">Mobile</label>
                        <input  type="number" class="form-control" id="mobile" name="mobile" placeholder="1234 Main St" required="">
                        <div class="invalid-feedback"> Please enter your shipping address. </div>
                    </div>

                    <div class="mb-3">
                        <label for="address">Address</label>
                        <input type="text" class="form-control" name="street" id="street"placeholder="1234 Main St" required="">
                        <div class="invalid-feedback"> Please enter your shipping address. </div>
                    </div>
                   
                  
                    <hr class="mb-4">
                    <h4 class="mb-3">Payment</h4>
                    <div class="payment_method">
                        <div class="panel-default">


                            

                            <a class="btn btn-primary btn-sm btn-block my-2" onclick="cashOnDelivary('<%= userId %>')">Chash On
                                delivary</a>
                        
                            <a  data-value="OnlinePayment" type="submit" onclick="onlinePayment('<%= userId %>')" class="btn btn-danger btn-sm btn-block my-2"  id="rzp-button1">Online Payment</a>


                            <!-- </form> -->
                        </div>
                    </div>
                    
                    <hr class="mb-4">
                   
                </form>
            </div>
        </div>
        <footer class="my-5 pt-5 text-muted text-center text-small">
            <p class="mb-1">© 2017-2019 Company Name</p>
            <ul class="list-inline">
                <li class="list-inline-item"><a href="#">Privacy</a></li>
                <li class="list-inline-item"><a href="#">Terms</a></li>
                <li class="list-inline-item"><a href="#">Support</a></li>
            </ul>
        </footer>
    </div>





















    </body>
    <script>
        async function updateAddressDetails(addressId) {
            const res = await fetch('/getAddressDetails/' + addressId);
            const data = await res.json();
            console.log("hiiii")
            console.log('Data retrieved from the server:', data);
            if (data.message === 'Address not found') {
                document.querySelector('#name').value = "";
                document.querySelector('#state').value = "";
                document.querySelector('#city').value = "";
                document.querySelector('#street').value = "";
                document.querySelector('#email').value = "";
                document.getElementById('#mobile').value = "";
               
            } else {
                document.querySelector('#name').value = data.Fullname;
                document.querySelector('#state').value = data.state;
                document.querySelector('#city').value = data.city;
                document.querySelector('#street').value = data.houseaddress;
                document.querySelector('#email').value = data.email;
                document.getElementById('mobile').value = data.mobile;
            }
        }
    </script>
    <script src="/public/asset/carts.js"> </script>
    <script>
        
  
function cashOnDelivary(userId){
  const amount = document.querySelector("#totalAmount").innerText;
  const name = document.querySelector("#name").value;
  const state = document.querySelector("#state").value;
  const city = document.querySelector("#city").value;
  const street = document.querySelector("#street").value;
  const email = document.querySelector("#email").value;
  const mobile = document.getElementById("mobile").value;
  console.log('amount,name,state,city,street,email,mobile')
  const url = window.location.origin;
  console.log(url);
 
  if (!name || !state || !city || !street || !email || !mobile) {
    swal({
      title: "Error",
      text: "Please fill in all required fields",
      icon: "error",
      button: "Okay",
    });
    return;
  }

  // Validate email address
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!emailRegex.test(email)) {
    swal({
      title: "Error",
      text: "Please enter a valid email address",
      icon: "error",
      button: "Okay",
    });
    return;
  }

  // Validate mobile number
  const mobileRegex = /^\d{10}$/;
  if (!mobileRegex.test(mobile)) {
    swal({
      title: "Error",
      text: "Please enter a valid 10-digit mobile number",
      icon: "error",
      button: "Okay",
    });
    return;
  }
  



  fetch(`${url}/cashon-delivery?userId=${userId}`, {
      method: 'POST',
      headers: {
      'Accept': 'application/json',
      'Content-Type': 'application/json'
      },
      body: JSON.stringify({

        amount,name,state,city,street,email,mobile
     
      })
  })
      .then((response) => {
      if (response.ok) {
          return response.json();
      }
      throw new Error('Network response was not ok');
      }) .then((data) => {
      console.log(data, "This is data");
      swal({
        title: "Order Placed Successfully!",
        text: `Your order has been placed successfully! Your order id is ${data.orderId}`,
        icon: "success",
        button: "Okay",
      }) .then(() => {
              window.location.href = `/trackoder`;
          });
          setTimeout(() => {
        window.location.href = `/trackoder`;
      }, 3000);
    })
      .catch((error) => {
      console.error(`There was a problem with the fetch operation: ${error.message}`);
      // Show error modal
      swal({
          title: "Error",
          text: "There was an error placing your order. Please try again later.",
          icon: "error",
          button: "Okay",
      });
      });
}









    </script>
   
 
   <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.4/dist/sweetalert2.min.js"></script>

 <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
   




